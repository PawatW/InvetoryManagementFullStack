sequenceDiagram
    actor Foreman
    participant RequestsPage as RequestsPage (app/(dashboard)/requests/page.tsx)
    participant PendingHook as useAuthedSWR('/requests/pending')
    participant ItemsHook as useAuthedSWR(`/requests/${id}/items`)
    participant ApiFetch as apiFetch(...)
    participant Backend as Inventory API

    Foreman->>RequestsPage: เปิดแท็บ "คำขอรออนุมัติ"
    RequestsPage->>PendingHook: useAuthedSWR('/requests/pending', token)
    PendingHook->>ApiFetch: apiFetch('/requests/pending', { token })
    ApiFetch->>Backend: GET /requests/pending
    Backend-->>RequestsPage: รายการคำขอ Pending

    Foreman->>RequestsPage: ขยายคำขอเพื่อดูรายละเอียด
    RequestsPage->>ItemsHook: useAuthedSWR(`/requests/${requestId}/items`, token)
    ItemsHook->>ApiFetch: apiFetch(`/requests/${requestId}/items`, { token })
    ApiFetch->>Backend: GET /requests/{requestId}/items
    Backend-->>RequestsPage: รายการสินค้าในคำขอ

    Foreman->>RequestsPage: กด Approve หรือ Reject
    RequestsPage->>RequestsPage: handleApprove(requestId, action)
    RequestsPage->>ApiFetch: apiFetch(`/requests/${requestId}/${action}`, { method: 'PUT', token })
    ApiFetch->>Backend: PUT /requests/{id}/{approve|reject}
    Backend-->>ApiFetch: ผลลัพธ์สำเร็จ
    ApiFetch-->>RequestsPage: อัปเดตสถานะเรียบร้อย
    RequestsPage->>RequestsPage: setSuccessMessage() + setError(null)
    RequestsPage->>PendingHook: mutate()
    PendingHook->>ApiFetch: apiFetch('/requests/pending', { token })
    ApiFetch->>Backend: GET /requests/pending (refresh)
    Backend-->>RequestsPage: รายการที่อัปเดตแล้ว
    RequestsPage-->>Foreman: แสดงผลการอนุมัติ/ปฏิเสธ
